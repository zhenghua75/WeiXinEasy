/*** swipe.js ***/
function Swipe(a, b) { function h() { var b, c, f, h; for (e.showDot && e.dotsElement && j(e.startSlide), g.slideCount < 2 && (e.continuous = !1), g.slideWidth = $(a).width(), g.slideHeight = 1 * g.slideWidth / 2, g.swipeWrap.style.width = g.slideCount * g.slideWidth + "px", e.width && e.fixWidth && (a.style.width = e.width + "px", g.slideWidth = e.width), e.height && e.fixHeight && (a.style.height = e.height + "px", g.slideHeight = e.height, g.swipeWrap.style.height = e.height, a.style.height = e.height), b = g.slideCount; b--;) c = g.slideEles[b], c.style.width = g.slideWidth + "px", c.children[0].style.width = g.slideWidth + "px", e.fixHeight && (c.style.height = g.slideHeight + "px", c.children[0].style.height = g.slideHeight + "px"), c.setAttribute("data-index", b), e.dotsElement || 0 != $(c).find(".dots").length || (f = i(b), f && c.appendChild(f)), d.transitions && (c.style.left = b * -g.slideWidth + "px", p(b, g.index > b ? -g.slideWidth : g.index < b ? g.slideWidth : 0, 0)); e.continuous && d.transitions && (p(m(g.index - 1), -g.slideWidth, 0), p(m(g.index + 1), g.slideWidth, 0)), d.transitions || (g.swipeWrap.style.left = g.index * -g.slideWidth + "px"), a.style.visibility = "visible", window.swipeImgs || (window.swipeImgs = "", $(g.swipeWrap).find("img").each(function () { window.swipeImgs += fullctx + $(this).attr("lazysrc") + ";" }), window.swipeImgs = window.swipeImgs.replace(/;$/, "")), e.showOrgImg && 0 == $("#original-img-div").length && (h = ['<div id="original-img-div" style="display:none;width:100%;max-width:800px;position:fixed;top:0px;left:0px;background:#000;z-index: 1;">'], h[h.length] = '<div style="display:table;height:100%;width:100%;">', h[h.length] = '<div id="prev-img-div" style="width:100%;vertical-align:middle;display:table-cell;">', h[h.length] = '<img id="prev-img" src="' + ctx + '/site/images/default.jpg" style="width:100%;">', h[h.length] = "</div>", h[h.length] = "</div>", h[h.length] = "</div>", $("body").append(h.join("")), g.hammer = Hammer(document.getElementById("prev-img-div"), { transform_always_block: !0, transform_min_scale: 1, drag_block_horizontal: !0, drag_block_vertical: !0, drag_min_distance: 10 }), g.prevImg = document.getElementById("prev-img"), g.posX = 0, g.posY = 0, g.scale = 1, g.last_scale, g.rotation = 0, g.last_rotation, g.lastX = 0, g.lastY = 0, g.hammer.on("click touch tap drag transform", function (a) { switch (a.type) { case "touch": g.last_scale = g.scale, g.last_rotation = g.rotation, g.lastY = g.posY, g.lastX = g.posX; break; case "click": $("#original-img-div").hide(); break; case "drag": g.posX = g.lastX + a.gesture.deltaX, g.posY = g.lastY + a.gesture.deltaY; break; case "transform": g.rotation = g.last_rotation + a.gesture.rotation, g.scale = Math.max(1, Math.min(g.last_scale * a.gesture.scale, 10)) } a.preventDefault(); var b = "rotate(0deg) "; (Math.abs(g.posX) > 30 || Math.abs(g.posY) > 30) && (b = "translate3d(" + g.posX + "px," + g.posY + "px, 0) "), b += "scale3d(" + g.scale + "," + g.scale + ", 0) ", g.prevImg.style.transform = b, g.prevImg.style.oTransform = b, g.prevImg.style.msTransform = b, g.prevImg.style.mozTransform = b, g.prevImg.style.webkitTransform = b }), $(g.swipeWrap).delegate("img", "click", function () { $("#prev-img").attr("src", ctx + $(this).attr("lazysrc")), $("#original-img-div").css("left", $("body").width() > 800 ? ($("body").width() - 800) / 2 : 0).height($(window).height()), $("#original-img-div").show() }), $(window).on("resize", function () { $("#original-img-div").height($(window).height()) })) } function i(a) { var c, d, e, b = g.slideCount; if (2 > b) return null; for (c = [], d = 0; b > d; d++) c[d] = a == d ? '<b class="select"></b>' : "<b></b>"; return e = document.createElement("span"), e.className = "dots", e.innerHTML = c.join(""), e } function j() { var b, c; if (!(g.dotsElement || (b = g.slideCount, 2 > b))) { for (c = ['<b class="select"></b>'], b--; b--;) c[c.length] = "<b></b>"; g.dotsElement = document.createElement("span"), g.dotsElement.className = "dots", g.dotsElement.innerHTML = c.join(""), g.dotsElement.style.position = "static", "string" == typeof e.dotsElement ? document.getElementById(e.dotsElement).appendChild(g.dotsElement) : e.dotsElement.appendChild(g.dotsElement) } } function k() { n(g.index - 1) } function l() { n(g.index + 1) } function m(a) { return (g.slideCount + a % g.slideCount) % g.slideCount } function n(a, b) { var c, f, h; if (g.index != a) { if (d.transitions) { for (c = Math.abs(g.index - a) / (g.index - a), e.continuous && (f = c, c = -g.slidePos[m(a)] / g.slideWidth, c !== f && (a = -c * g.slideCount + a)), h = Math.abs(g.index - a) - 1; h--;) p(m((a > g.index ? a : g.index) - h - 1), g.slideWidth * c, 0); a = m(a), p(g.index, g.slideWidth * c, b || e.speed), p(a, 0, b || e.speed), e.continuous && (2 == g.slideCount ? (p(m(a + 1), g.slideWidth * c, b || e.speed), g.timeout = setTimeout(function () { p(m(a + 1), -1 * g.slideWidth * c, 0), clearTimeout(g.timeout) }, b || e.speed)) : p(m(a - c), -(g.slideWidth * c), 0)) } else a = m(a), 1 * a < 1 * g.index ? r(g.index * -g.slideWidth, a * -g.slideWidth, 1) : r(g.index * -g.slideWidth, a * -g.slideWidth, b || e.speed); g.index = a, "function" == typeof e.slideEnd && e.slideEnd.apply(this, [g.index, g.slideCount, g.slideEles[g.index]]), o() } } function o() { var a, b, c; if (g.dotsElement && e.dotsElement) { for (a = g.dotsElement.children, b = 0, c = a.length; c > b; b++) a[b].className = ""; a[g.index].className = "select" } } function p(a, b, c) { q(a, b, c), g.slidePos[a] = b } function q(a, b, c) { var d = g.slideEles[a], e = d && d.style; e && (e.webkitTransitionDuration = e.MozTransitionDuration = e.msTransitionDuration = e.OTransitionDuration = e.transitionDuration = c + "ms", e.webkitTransform = "translate(" + b + "px,0)" + "translateZ(0)", e.msTransform = e.MozTransform = e.OTransform = "translateX(" + b + "px)") } function r(a, b, c) { var d, f; return c ? (d = +new Date, f = setInterval(function () { var h = +new Date - d; return h > c ? (g.swipeWrap.style.left = b + "px", e.auto && s(), "function" == typeof e.slideEnd && e.slideEnd.apply(this, [g.index, g.slideCount, g.slideEles[g.index]]), clearInterval(f), void 0) : (g.swipeWrap.style.left = (b - a) * (Math.floor(100 * (h / c)) / 100) + a + "px", void 0) }, 4), void 0) : (g.swipeWrap.style.left = b + "px", void 0) } function s() { g.slideInterval = setTimeout(l, e.delay) } function t() { clearTimeout(g.slideInterval) } var c, d, e, f, g, u; if (a) { c = function (a) { setTimeout(a || function () { }, 0) }, d = { addEventListener: !!window.addEventListener, touch: "ontouchstart" in window || window.DocumentTouch && document instanceof DocumentTouch, transitions: function (a) { var c, b = ["transitionProperty", "WebkitTransition", "MozTransition", "OTransition", "msTransition"]; for (c in b) if (void 0 !== a.style[b[c]]) return !0; return !1 }(document.createElement("div")) }, e = { width: 0, height: 0, startSlide: 0, speed: 1e3, continuous: !0, slideEnd: function () { }, dotsElement: null, delay: 2e3, stopPropagation: !1, disableScroll: !1, auto: !0, fixHeight: !0, fixWidth: !0, showDot: !0, showOrgImg: !1 }; for (f in b) e[f] = b[f]; return g = { index: e.startSlide, slideInterval: null, evtStart: {}, evtDelta: {}, isScrolling: !1, slideEles: a.children[0].children, slidePos: [], slideWidth: 0, slideHeight: 0, slideCount: a.children[0].children.length, dotsElement: null, swipeWrap: a.children[0] }, u = { handleEvent: function (a) { switch (a.type) { case "touchstart": this.start(a); break; case "touchmove": this.move(a); break; case "touchend": c(this.end(a)); break; case "webkitTransitionEnd": case "msTransitionEnd": case "oTransitionEnd": case "otransitionend": case "transitionend": c(this.transitionEnd(a)); break; case "resize": c(h.call()) } e.stopPropagation && a.stopPropagation() }, start: function (a) { var b = a.touches[0]; g.evtStart = { x: b.pageX, y: b.pageY, time: (new Date).getTime() }, g.isScrolling = void 0, g.evtDelta = {}, g.swipeWrap.addEventListener("touchmove", this, !1), g.swipeWrap.addEventListener("touchend", this, !1) }, move: function (a) { if (!(a.touches.length > 1 || a.scale && 1 !== a.scale)) { e.disableScroll && a.preventDefault(); var b = a.touches[0]; g.evtDelta = { x: b.pageX - g.evtStart.x, y: b.pageY - g.evtStart.y }, "undefined" == typeof g.isScrolling && (g.isScrolling = !!(g.isScrolling || Math.abs(g.evtDelta.x) < Math.abs(g.evtDelta.y))), g.isScrolling || (a.preventDefault(), t(), e.continuous ? (q(m(g.index - 1), g.evtDelta.x + g.slidePos[m(g.index - 1)], 0), q(g.index, g.evtDelta.x + g.slidePos[g.index], 0), q(m(g.index + 1), g.evtDelta.x + g.slidePos[m(g.index + 1)], 0)) : (g.evtDelta.x = g.evtDelta.x / (!g.index && g.evtDelta.x > 0 || g.index == g.slideCount - 1 && g.evtDelta.x < 0 ? Math.abs(g.evtDelta.x) / g.slideWidth + 1 : 1), q(g.index - 1, g.evtDelta.x + g.slidePos[g.index - 1], 0), q(g.index, g.evtDelta.x + g.slidePos[g.index], 0), q(g.index + 1, g.evtDelta.x + g.slidePos[g.index + 1], 0))) } }, end: function () { var b = (new Date).getTime() - g.evtStart.time, c = Number(b) < 250 && Math.abs(g.evtDelta.x) > 10 || Math.abs(g.evtDelta.x) > 10, d = !g.index && g.evtDelta.x > 0 || g.index == g.slideCount - 1 && g.evtDelta.x < 0; e.continuous && (d = !1), g.isScrolling || (c && !d ? (g.evtDelta.x < 0 ? n(g.index + 1, 10) : n(g.index - 1, 10), o(), "function" == typeof e.slideEnd && e.slideEnd.apply(this, [g.index, g.slideCount, g.slideEles[g.index]])) : e.continuous ? (p(m(g.index - 1), -g.slideWidth, e.speed), p(g.index, 0, e.speed), p(m(g.index + 1), g.slideWidth, e.speed)) : (p(g.index - 1, -g.slideWidth, e.speed), p(g.index, 0, e.speed), p(g.index + 1, g.slideWidth, e.speed))), g.swipeWrap.removeEventListener("touchmove", u, !1), g.swipeWrap.removeEventListener("touchend", u, !1) }, transitionEnd: function (a) { parseInt(a.target.getAttribute("data-index")) == g.index && (e.auto && s(), "function" == typeof e.slideEnd && e.slideEnd.apply(this, [g.index, g.slideCount, g.slideEles[g.index]])) } }, h(), e.auto && s(), d.addEventListener ? (d.touch && g.swipeWrap.addEventListener("touchstart", u, !1), d.transitions && (g.swipeWrap.addEventListener("webkitTransitionEnd", u, !1), g.swipeWrap.addEventListener("msTransitionEnd", u, !1), g.swipeWrap.addEventListener("oTransitionEnd", u, !1), g.swipeWrap.addEventListener("otransitionend", u, !1), g.swipeWrap.addEventListener("transitionend", u, !1)), window.addEventListener("resize", u, !1)) : window.onresize = function () { h() }, { setup: function () { h() }, slide: function (a, b) { t(), n(a, b) }, prev: function () { t(), k() }, next: function () { t(), l() }, getPos: function () { return g.index }, getNumSlides: function () { return g.slideCount }, kill: function () { var a, b; for (t(), g.swipeWrap.style.width = "auto", g.swipeWrap.style.left = 0, a = g.slideCount; a--;) b = g.slideEles[a], b.style.width = "100%", b.style.left = 0, d.transitions && q(a, 0, 0); d.addEventListener ? (g.swipeWrap.removeEventListener("touchstart", u, !1), g.swipeWrap.removeEventListener("webkitTransitionEnd", u, !1), g.swipeWrap.removeEventListener("msTransitionEnd", u, !1), g.swipeWrap.removeEventListener("oTransitionEnd", u, !1), g.swipeWrap.removeEventListener("otransitionend", u, !1), g.swipeWrap.removeEventListener("transitionend", u, !1), window.removeEventListener("resize", u, !1)) : window.onresize = null } } } } (window.jQuery || window.Zepto) && function (a) { a.fn.Swipe = function (b) { return this.each(function () { a(this).data("Swipe", new Swipe(a(this)[0], b)) }) } }(window.jQuery || window.Zepto);



